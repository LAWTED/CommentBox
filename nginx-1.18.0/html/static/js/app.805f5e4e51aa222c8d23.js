webpackJsonp([1],{"0R1s":function(t,e){},"6qRC":function(t,e){},Fkew:function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("7+uW"),s={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"postBody"},[t.show?n("div",[n("h1",[t._v(t._s(t.post.title))])]):n("div",[n("h1",[t._v("loading...")])]),t._v(" "),n("div",{staticClass:"comment-count"},[t._v("\n    "+t._s(t.commentCount)+" 条评论\n  ")])])},staticRenderFns:[]};var a={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"commentbox"},[n("div",{staticClass:"commentForm"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.message,expression:"message"}],attrs:{placeholder:"  友善的评论是交流的起点",onfocus:"this.placeholder=''",onblur:"this.placeholder='  友善的评论是交流的起点'"},domProps:{value:t.message},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submitComment(e)},input:function(e){e.target.composing||(t.message=e.target.value)}}}),t._v(" "),n("button",{on:{click:t.submitComment}},[t._v("提交")])]),t._v(" "),t._l(t.reversedComments,function(e){return n("div",{key:e.id,staticClass:"commentShow"},[t._v("\n    "+t._s(e.body)+"\n  ")])})],2)},staticRenderFns:[]};var r={name:"Post",components:{PostBody:n("VU/8")({name:"PostBody",props:["postId"],computed:{show:function(){return this.post},commentCount:function(){return this.$store.getters.getComments(this.postId).length},post:function(){var t=this;return this.$store.state.post.all.find(function(e){return e.id===t.postId})}}},s,!1,function(t){n("gGgv")},"data-v-30bb2f36",null).exports,CommentBox:n("VU/8")({name:"CommentBox",data:function(){return{message:""}},computed:{postId:function(){return this.$route.params.id},comments:function(){return this.$store.getters.getComments(this.postId)},reversedComments:function(){return this.comments.slice().reverse()}},methods:{submitComment:function(){if(this.message){var t={body:this.message,post:this.postId};this.$store.dispatch({type:"addComment",comment:t}),this.message=""}}}},a,!1,function(t){n("vHvP")},"data-v-7b16a9fe",null).exports},data:function(){return{title:"在这里评论"}},computed:{postId:function(){return this.$route.params.id}},created:function(){this.$store.dispatch({type:"loadComments"}),this.$store.dispatch({type:"loadPosts"})}},i={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"post"},[e("div",{staticClass:"upper"},[e("PostBody",{attrs:{postId:this.postId}})],1),this._v(" "),e("div",{staticClass:"bottom"},[e("CommentBox")],1)])},staticRenderFns:[]};var u=n("VU/8")(r,i,!1,function(t){n("0R1s")},"data-v-a2981864",null).exports,c={name:"app",created:function(){},components:{Post:u}},l={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]};var m=n("VU/8")(c,l,!1,function(t){n("lXWz")},null,null).exports,d=n("/ocq"),p={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"home"},[n("ul",t._l(t.posts,function(e){return n("li",{key:e.id},[n("div",{staticClass:"list"},[n("h2",[n("router-link",{attrs:{to:"post/"+e.id}},[t._v(t._s(e.title))])],1)])])}),0)])},staticRenderFns:[]};var f=n("VU/8")({name:"Home",computed:{posts:function(){return this.$store.state.post.all}},created:function(){this.$store.dispatch({type:"loadPosts"})}},p,!1,function(t){n("Fkew")},"data-v-dccf5386",null).exports,v={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mainPage"},[n("div",{staticClass:"homepage"},[n("h1",[t._v("主页面")]),t._v(" "),t.user?n("span",[t._v(" 你好，"+t._s(t.user.name)),n("br"),n("br"),n("br"),t._v(" "),n("el-button",{attrs:{type:"warning"},on:{click:t.login}},[t._v("注销")])],1):n("el-button",{attrs:{type:"success"},on:{click:t.login}},[t._v("点击登录")])],1)])},staticRenderFns:[]};var h=n("VU/8")({methods:{login:function(){this.$router.replace("/login")},logout:function(){var t=this;this.$store.dispatch("logout").then(function(){t.$router.replace("/login")})}},computed:{user:function(){return this.$store.state.user}}},v,!1,function(t){n("mAN/")},null,null).exports,g={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"home"},[n("el-row",{attrs:{type:"flex",justify:"center"}},[n("el-form",{ref:"loginForm",attrs:{model:t.user,rules:t.rules,"label-width":"80px"}},[n("el-form-item",{attrs:{label:"用户名",prop:"name"}},[n("el-input",{model:{value:t.user.name,callback:function(e){t.$set(t.user,"name",e)},expression:"user.name"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"密码",prop:"pass"}},[n("el-input",{attrs:{type:"password"},model:{value:t.user.pass,callback:function(e){t.$set(t.user,"pass",e)},expression:"user.pass"}})],1),t._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary",icon:"el-icon-upload"},on:{click:t.login}},[t._v("登录")])],1)],1)],1)],1)},staticRenderFns:[]};var _=n("VU/8")({methods:{login:function(){var t=this;this.$refs.loginForm.validate(function(e){if(!e)return!1;t.$axios.post("/api/validate",t.user).then(function(e){e.data?t.$store.dispatch("login",t.user).then(function(){t.$notify({type:"success",message:"欢迎你,"+t.user.name+"!",duration:3e3}),t.$router.replace("/home")}):t.$message({type:"error",message:"用户名或密码错误",showClose:!0})})})}},data:function(){return{user:{},rules:{name:[{required:!0,message:"用户名不能为空",trigger:"blur"}],pass:[{required:!0,message:"密码不能为空",trigger:"blur"}]}}}},g,!1,function(t){n("6qRC")},"data-v-45e40ade",null).exports;o.default.use(d.a);var C=new d.a({mode:"hash",routes:[{path:"/",name:"Main",component:h},{path:"/home",component:f},{path:"/post/:id",component:u},{path:"/login",name:"Login",component:_}]}),$=n("NYxO"),y=n("mtWM"),b=n.n(y),x={state:{all:[]},mutations:{addComment:function(t,e){t.all.push(e)},loadComments:function(t,e){t.all=e}},actions:{addComment:function(t,e){var n=t.commit,o=e.comment;b.a.post("/api/Ecomments",o).then(function(t){var e=t.data;n("addComment",e)})},loadComments:function(t){var e=t.commit;b.a.get("/api/Ecomments").then(function(t){var n=t.data;e("loadComments",n)})}},getters:{getComments:function(t){return function(e){return t.all.filter(function(t){return t.post===e})}}}},k={state:{all:[]},mutations:{loadPosts:function(t,e){t.all=e}},actions:{loadPosts:function(t){var e=t.commit;b.a.get("/api/Epost").then(function(t){var n=t.data;e("loadPosts",n)})}}},w={state:{user:void 0},mutations:{login:function(t,e){t.user=e},logout:function(t){t.user=void 0}},actions:{login:function(t,e){t.commit("login",e)},logout:function(t){t.commit("logout")}}};o.default.use($.a);var P=new $.a.Store({modules:{comment:x,post:k,login:w}}),R=n("zL8q"),E=n.n(R);n("tvR6");o.default.use(E.a),o.default.prototype.$axios=b.a,o.default.config.productionTip=!1,new o.default({el:"#app",components:{App:m},router:C,store:P,template:"<App/>"}),C.beforeEach(function(t,e,n){console.log(P),"/login"===t.path||P.state.login.user?n():n({path:"/login"})})},gGgv:function(t,e){},lXWz:function(t,e){},"mAN/":function(t,e){},tvR6:function(t,e){},vHvP:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.805f5e4e51aa222c8d23.js.map